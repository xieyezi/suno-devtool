{
  "version": 3,
  "sources": ["../../../../../../../../front_end/ui/legacy/components/inline_editor/LinkSwatch.ts"],
  "sourcesContent": ["// Copyright (c) 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../../core/i18n/i18n.js';\nimport * as Platform from '../../../../core/platform/platform.js';\nimport * as ComponentHelpers from '../../../components/helpers/helpers.js';\nimport * as LitHtml from '../../../lit-html/lit-html.js';\n\nimport linkSwatchStyles from './linkSwatch.css.js';\n\nconst UIStrings = {\n  /**\n   *@description Text displayed in a tooltip shown when hovering over a var() CSS function in the Styles pane when the custom property in this function does not exist. The parameter is the name of the property.\n   *@example {--my-custom-property-name} PH1\n   */\n  sIsNotDefined: '{PH1} is not defined',\n};\nconst str_ = i18n.i18n.registerUIStrings('ui/legacy/components/inline_editor/LinkSwatch.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst {render, html, Directives} = LitHtml;\n\ninterface LinkSwatchRenderData {\n  text: string;\n  title: string;\n  isDefined: boolean;\n  onLinkActivate: (linkText: string) => void;\n}\n\n/* eslint-disable-next-line rulesdir/check_component_naming */\nclass LinkSwatch extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-link-swatch`;\n  protected readonly shadow = this.attachShadow({mode: 'open'});\n  protected onLinkActivate: (linkText: string, event: MouseEvent|KeyboardEvent) => void = () => undefined;\n\n  connectedCallback(): void {\n    this.shadow.adoptedStyleSheets = [linkSwatchStyles];\n  }\n\n  set data(data: LinkSwatchRenderData) {\n    this.onLinkActivate = (linkText: string, event: MouseEvent|KeyboardEvent): void => {\n      if (event instanceof MouseEvent && event.button !== 0) {\n        return;\n      }\n\n      if (event instanceof KeyboardEvent && !Platform.KeyboardUtilities.isEnterOrSpaceKey(event)) {\n        return;\n      }\n\n      data.onLinkActivate(linkText);\n      event.consume(true);\n    };\n    this.render(data);\n  }\n\n  private render(data: LinkSwatchRenderData): void {\n    const {isDefined, text, title} = data;\n    const classes = Directives.classMap({\n      'link-swatch-link': true,\n      'undefined': !isDefined,\n    });\n    // The linkText's space must be removed, otherwise it cannot be triggered when clicked.\n    const onActivate = isDefined ? this.onLinkActivate.bind(this, text.trim()) : null;\n\n    render(\n        html`<span class=${classes} title=${title} @mousedown=${onActivate} @keydown=${\n            onActivate} role=\"link\" tabindex=\"-1\">${text}</span>`,\n        this.shadow, {host: this});\n  }\n}\n\nconst VARIABLE_FUNCTION_REGEX = /(^var\\()\\s*(--(?:[\\s\\w\\P{ASCII}-]|\\\\.)+)(,?\\s*.*)\\s*(\\))$/u;\n\ninterface CSSVarSwatchRenderData {\n  text: string;\n  computedValue: string|null;\n  fromFallback: boolean;\n  onLinkActivate: (linkText: string) => void;\n}\n\ninterface ParsedVariableFunction {\n  pre: string;\n  variableName: string;\n  fallbackIncludeComma: string;\n  post: string;\n}\n\nexport class CSSVarSwatch extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-css-var-swatch`;\n  protected readonly shadow = this.attachShadow({mode: 'open'});\n\n  constructor() {\n    super();\n\n    this.tabIndex = -1;\n\n    this.addEventListener('focus', () => {\n      const link = this.shadow.querySelector<HTMLElement>('[role=\"link\"]');\n\n      if (link) {\n        link.focus();\n      }\n    });\n  }\n\n  set data(data: CSSVarSwatchRenderData) {\n    this.render(data);\n  }\n\n  private parseVariableFunctionParts(text: string): ParsedVariableFunction|null {\n    // When the value of CSS var() is greater than two spaces, only one is\n    // always displayed, and the actual number of spaces is displayed when\n    // editing is clicked.\n    const result = text.replace(/\\s{2,}/g, ' ').match(VARIABLE_FUNCTION_REGEX);\n    if (!result) {\n      return null;\n    }\n\n    return {\n      // Returns `var(`\n      pre: result[1],\n\n      // Returns the CSS variable name, e.g. `--foo`\n      variableName: result[2],\n\n      // Returns the fallback value in the CSS variable, including a comma if\n      // one is present, e.g. `,50px`\n      fallbackIncludeComma: result[3],\n\n      // Returns `)`\n      post: result[4],\n    };\n  }\n\n  private variableName(text: string): string {\n    const match = text.match(VARIABLE_FUNCTION_REGEX);\n    if (match) {\n      return match[2];\n    }\n    return '';\n  }\n\n  protected render(data: CSSVarSwatchRenderData): void {\n    const {text, fromFallback, computedValue, onLinkActivate} = data;\n    const functionParts = this.parseVariableFunctionParts(text);\n    if (!functionParts) {\n      render('', this.shadow, {host: this});\n      return;\n    }\n\n    const isDefined = Boolean(computedValue) && !fromFallback;\n    const title = isDefined ? computedValue : i18nString(UIStrings.sIsNotDefined, {PH1: this.variableName(text)});\n    const fallbackIncludeComma = functionParts.fallbackIncludeComma ? functionParts.fallbackIncludeComma : '';\n\n    render(\n        html`<span title=${data.computedValue || ''}>${functionParts.pre}<${LinkSwatch.litTagName} .data=${\n            {title, text: functionParts.variableName, isDefined, onLinkActivate} as\n            LinkSwatchRenderData}></${LinkSwatch.litTagName}>${fallbackIncludeComma}${functionParts.post}</span>`,\n        this.shadow, {host: this});\n  }\n}\n\ninterface AnimationNameSwatchRenderData {\n  isDefined: boolean;\n  text: string;\n  onLinkActivate: (linkText: string) => void;\n}\n\nexport class AnimationNameSwatch extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-animation-name-swatch`;\n  protected readonly shadow = this.attachShadow({mode: 'open'});\n\n  set data(data: AnimationNameSwatchRenderData) {\n    this.render(data);\n  }\n\n  protected render(data: AnimationNameSwatchRenderData): void {\n    const {text, isDefined, onLinkActivate} = data;\n    const title = isDefined ? text : i18nString(UIStrings.sIsNotDefined, {PH1: text});\n    render(\n        html`<span title=${data.text}><${LinkSwatch.litTagName} .data=${{\n          text,\n          isDefined,\n          title,\n          onLinkActivate,\n        } as LinkSwatchRenderData}></${LinkSwatch.litTagName}></span>`,\n        this.shadow, {host: this});\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-animation-name-swatch', AnimationNameSwatch);\nComponentHelpers.CustomElements.defineComponent('devtools-css-var-swatch', CSSVarSwatch);\nComponentHelpers.CustomElements.defineComponent('devtools-link-swatch', LinkSwatch);\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  interface HTMLElementTagNameMap {\n    'devtools-link-swatch': LinkSwatch;\n    'devtools-animation-name-swatch': AnimationNameSwatch;\n    'devtools-css-var-swatch': CSSVarSwatch;\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
