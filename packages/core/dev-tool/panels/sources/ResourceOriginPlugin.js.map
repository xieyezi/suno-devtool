{
  "version": 3,
  "sources": ["../../../../../../front_end/panels/sources/ResourceOriginPlugin.ts"],
  "sourcesContent": ["// Copyright 2018 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport * as Bindings from '../../models/bindings/bindings.js';\nimport type * as Workspace from '../../models/workspace/workspace.js';\nimport * as Components from '../../ui/legacy/components/utils/utils.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport {Plugin} from './Plugin.js';\n\nconst UIStrings = {\n  /**\n   *@description Text in Resource Origin Plugin of the Sources panel\n   *@example {example.com} PH1\n   */\n  sourceMappedFromS: '(source mapped from {PH1})',\n  /**\n   *@description Text in Resource Origin Plugin of the Sources panel\n   *@example {http://localhost/file.wasm} PH1\n   */\n  providedViaDebugInfoByS: '(provided via debug info by {PH1})',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/sources/ResourceOriginPlugin.ts', UIStrings);\n\nexport class ResourceOriginPlugin extends Plugin {\n  static accepts(uiSourceCode: Workspace.UISourceCode.UISourceCode): boolean {\n    const contentType = uiSourceCode.contentType();\n    return contentType.hasScripts() || contentType.isFromSourceMap();\n  }\n\n  async rightToolbarItems(): Promise<UI.Toolbar.ToolbarItem[]> {\n    const originURLs = [\n      ...Bindings.CompilerScriptMapping.CompilerScriptMapping.uiSourceCodeOrigin(this.uiSourceCode),\n      ...Bindings.SASSSourceMapping.SASSSourceMapping.uiSourceOrigin(this.uiSourceCode),\n    ];\n    if (originURLs.length) {\n      return originURLs.map(originURL => {\n        const item = i18n.i18n.getFormatLocalizedString(\n            str_, UIStrings.sourceMappedFromS, {PH1: Components.Linkifier.Linkifier.linkifyURL(originURL)});\n        return new UI.Toolbar.ToolbarItem(item);\n      });\n    }\n\n    const pluginManager = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance().pluginManager;\n    if (pluginManager) {\n      for (const originScript of pluginManager.scriptsForUISourceCode(this.uiSourceCode)) {\n        if (originScript.sourceURL) {\n          const item = i18n.i18n.getFormatLocalizedString(\n              str_, UIStrings.providedViaDebugInfoByS,\n              {PH1: Components.Linkifier.Linkifier.linkifyURL(originScript.sourceURL)});\n          return [new UI.Toolbar.ToolbarItem(item)];\n        }\n      }\n    }\n\n    // Handle anonymous scripts with an originStackTrace.\n    const script = await ResourceOriginPlugin.script(this.uiSourceCode);\n    if (!script || !script.originStackTrace) {\n      return [];\n    }\n    const link = linkifier.linkifyStackTraceTopFrame(script.debuggerModel.target(), script.originStackTrace);\n    return [new UI.Toolbar.ToolbarItem(link)];\n  }\n\n  private static async script(uiSourceCode: Workspace.UISourceCode.UISourceCode): Promise<SDK.Script.Script|null> {\n    const locations =\n        await Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance().uiLocationToRawLocations(\n            uiSourceCode, 0, 0);\n    for (const location of locations) {\n      const script = location.script();\n      if (script && script.originStackTrace) {\n        return script;\n      }\n    }\n    return null;\n  }\n}\n\nexport const linkifier = new Components.Linkifier.Linkifier();\n"],
  "mappings": "AAIA;AAEA;AAEA;AACA;AAEA;AAEA,MAAM,YAAY;AAAA,EAKhB,mBAAmB;AAAA,EAKnB,yBAAyB;AAAA;AAE3B,MAAM,OAAO,KAAK,KAAK,kBAAkB,0CAA0C;AAE5E,0CAAmC,OAAO;AAAA,SACxC,QAAQ,cAA4D;AACzE,UAAM,cAAc,aAAa;AACjC,WAAO,YAAY,gBAAgB,YAAY;AAAA;AAAA,QAG3C,oBAAuD;AAC3D,UAAM,aAAa;AAAA,MACjB,GAAG,SAAS,sBAAsB,sBAAsB,mBAAmB,KAAK;AAAA,MAChF,GAAG,SAAS,kBAAkB,kBAAkB,eAAe,KAAK;AAAA;AAEtE,QAAI,WAAW,QAAQ;AACrB,aAAO,WAAW,IAAI,eAAa;AACjC,cAAM,OAAO,KAAK,KAAK,yBACnB,MAAM,UAAU,mBAAmB,EAAC,KAAK,WAAW,UAAU,UAAU,WAAW;AACvF,eAAO,IAAI,GAAG,QAAQ,YAAY;AAAA;AAAA;AAItC,UAAM,gBAAgB,SAAS,yBAAyB,yBAAyB,WAAW;AAC5F,QAAI,eAAe;AACjB,iBAAW,gBAAgB,cAAc,uBAAuB,KAAK,eAAe;AAClF,YAAI,aAAa,WAAW;AAC1B,gBAAM,OAAO,KAAK,KAAK,yBACnB,MAAM,UAAU,yBAChB,EAAC,KAAK,WAAW,UAAU,UAAU,WAAW,aAAa;AACjE,iBAAO,CAAC,IAAI,GAAG,QAAQ,YAAY;AAAA;AAAA;AAAA;AAMzC,UAAM,SAAS,MAAM,qBAAqB,OAAO,KAAK;AACtD,QAAI,CAAC,UAAU,CAAC,OAAO,kBAAkB;AACvC,aAAO;AAAA;AAET,UAAM,OAAO,UAAU,0BAA0B,OAAO,cAAc,UAAU,OAAO;AACvF,WAAO,CAAC,IAAI,GAAG,QAAQ,YAAY;AAAA;AAAA,eAGhB,OAAO,cAAoF;AAC9G,UAAM,YACF,MAAM,SAAS,yBAAyB,yBAAyB,WAAW,yBACxE,cAAc,GAAG;AACzB,eAAW,YAAY,WAAW;AAChC,YAAM,SAAS,SAAS;AACxB,UAAI,UAAU,OAAO,kBAAkB;AACrC,eAAO;AAAA;AAAA;AAGX,WAAO;AAAA;AAAA;AAIJ,aAAM,YAAY,IAAI,WAAW,UAAU;",
  "names": []
}
